<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Protocol Design for Agent and MCP Server Registries</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace; /* Monospace font */
            background-color: #FFFFFF;
            color: #262626; /* Neutral-800 */
            scroll-behavior: smooth;
            font-size: 16px; /* Base font size for monospace for readability */
        }
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem; /* 24px */
        }
        .nav-link {
            color: #E5E5E5; /* Neutral-200 */
            transition: color 0.3s ease, background-color 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 0; /* Sharp corners for 90s look */
            font-weight: normal; /* Monospace handles weight differently */
            border: 1px solid #404040; /* Border for nav links */
            display: inline-block;
            margin-bottom: 0.125rem; /* Reduced margin */
            margin-right: 0.125rem; /* Reduced margin */
            text-decoration: none; /* Ensure no underline */
        }
        .nav-link:hover {
            background-color: #737373; /* Neutral-500 */
            color: #FFFFFF;
            border-color: #737373;
        }
        .nav-link.active {
            background-color: #404040; /* Neutral-700 */
            color: #FFFFFF;
            font-weight: bold; /* Monospace can use bold */
            border-color: #404040;
        }
        .section-title {
            color: #171717; /* Neutral-900 */
            border-bottom: 2px solid #525252; /* Neutral-600 */
            padding-bottom: 0.75rem; /* 12px */
            font-size: 1.75rem; /* Adjusted for monospace */
            font-weight: bold;
            text-transform: uppercase; /* 90s style */
        }
        .subsection-title {
            color: #262626; /* Neutral-800 */
            font-size: 1.15rem; /* Adjusted for monospace */
            font-weight: bold;
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 0.75rem; /* mb-3 */
        }
        .header-bg {
             background-color: #404040; /* Neutral-700 */
             border-bottom: 2px solid #171717; /* Neutral-900 */
        }
        .footer-bg {
            background-color: #404040; /* Neutral-700 */
            border-top: 2px solid #171717; /* Neutral-900 */
        }
        .footer-text {
            color: #D4D4D4; /* Neutral-300 */
        }
        
        /* Book-specific styling */
        .book-container {
            display: flex;
            min-height: calc(100vh - 120px); /* Adjust based on header/footer height */
        }
        .book-sidebar {
            width: 250px;
            background-color: #F5F5F5;
            border-right: 1px solid #A3A3A3;
            padding: 1rem;
            overflow-y: auto;
            position: sticky;
            top: 60px; /* Match header height */
            height: calc(100vh - 120px); /* Adjust based on header/footer height */
        }
        .book-content {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
        }
        .chapter-link {
            display: block;
            padding: 0.5rem;
            margin-bottom: 0.25rem;
            border: 1px solid #A3A3A3;
            background-color: #E5E5E5;
            color: #262626;
            text-decoration: none;
            font-size: 0.9rem;
            cursor: pointer;
        }
        .chapter-link:hover {
            background-color: #D4D4D4;
        }
        .chapter-link.active {
            background-color: #A3A3A3;
            font-weight: bold;
        }
        
        /* Markdown styling */
        .markdown-content h1 {
            font-size: 1.75rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: #171717;
            border-bottom: 2px solid #525252;
            padding-bottom: 0.5rem;
        }
        .markdown-content h2 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #262626;
        }
        .markdown-content h3 {
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #404040;
        }
        .markdown-content h4 {
            font-size: 1.1rem;
            font-weight: bold;
            margin-top: 1.25rem;
            margin-bottom: 0.5rem;
            color: #525252;
        }
        .markdown-content p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        .markdown-content pre {
            background-color: #F5F5F5;
            border: 1px solid #A3A3A3;
            padding: 1rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            font-size: 0.9rem;
        }
        .markdown-content code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #E5E5E5;
            padding: 0.1rem 0.25rem;
            border: 1px solid #A3A3A3;
            font-size: 0.9em;
        }
        .markdown-content ul, .markdown-content ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }
        .markdown-content li {
            margin-bottom: 0.5rem;
        }
        .markdown-content blockquote {
            border-left: 4px solid #A3A3A3;
            padding-left: 1rem;
            margin-left: 0;
            margin-right: 0;
            margin-bottom: 1rem;
            color: #525252;
        }
        
        /* User-provided styles for tables and diagrams */
        .card {
            background-color: #F5F5F5; /* Neutral-100 */
            border-radius: 0; /* Sharp corners */
            box-shadow: 2px 2px 0px #A3A3A3; /* Simple shadow for 90s */
            border: 1px solid #A3A3A3; /* Border for cards */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 1.5rem; /* mb-6 */
        }
        
        .info-box {
            background-color: #E5E5E5; /* Neutral-200 */
            border: 1px dashed #A3A3A3; /* Dashed border */
            padding: 1rem;
            border-radius: 0;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        
        .table-corporate {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem; /* Adjusted for monospace */
            border: 1px solid #737373; /* Table border */
        }
        
        .table-corporate th, .table-corporate td {
            padding: 0.5rem 0.75rem; /* Adjusted padding */
            border: 1px solid #A3A3A3; /* Neutral-400 */
            text-align: left;
        }
        
        .table-corporate th {
            background-color: #A3A3A3; /* Neutral-400 */
            color: #171717; /* Neutral-900 */
            font-weight: bold;
        }
        
        .table-corporate tbody tr:nth-child(even) {
            background-color: #E5E5E5; /* Neutral-200 */
        }
        
        .table-corporate tbody tr:hover {
            background-color: #D4D4D4; /* Neutral-300 */
        }
        
        .flow-step {
            background-color: #D4D4D4; /* Neutral-300 */
            border: 1px solid #737373; /* Neutral-500 */
            color: #171717; /* Neutral-900 */
            padding: 0.75rem 1.25rem;
            border-radius: 0;
            text-align: center;
            font-weight: normal;
        }
        
        .flow-arrow {
            font-size: 1.5rem; /* Adjusted */
            color: #525252; /* Neutral-600 */
            margin: 0.5rem 0;
            align-self: center;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
            height: 280px;
            max-height: 320px;
            background-color: #E5E5E5; /* Neutral-200 */
            padding: 1rem;
            border-radius: 0;
            border: 1px solid #A3A3A3; /* Neutral-400 */
        }
        
        .key-term {
            font-weight: bold;
            color: #262626; /* Neutral-800 */
            text-decoration: underline; /* 90s style */
        }
        
        .code-like {
            font-family: 'Courier New', Courier, monospace; /* Ensure monospace */
            background-color: #D4D4D4; /* Neutral-300 */
            padding: 0.1rem 0.25rem;
            border: 1px solid #A3A3A3; /* Border for code */
            font-size: 0.9em;
            color: #171717; /* Neutral-900 */
        }
        
        .text-lead {
            font-size: 1.05rem; /* Adjusted for monospace */
            color: #525252; /* Neutral-600 */
            line-height: 1.5;
        }
        
        .info-box-title {
            color: #171717; /* Neutral-900 */
            font-weight: bold;
        }
        
        .info-box-text {
            color: #262626; /* Neutral-800 */
        }
        
        .diagram-box {
             background-color: #FFFFFF;
             padding: 0.75rem;
             border-radius: 0;
             border: 1px solid #A3A3A3; /* Neutral-400 */
             font-size: 0.9rem; /* Adjusted */
        }
        
        .diagram-box-title {
            font-weight: bold;
            color: #171717; /* Neutral-900 */
        }
        
        .diagram-box-subtext {
            color: #262626; /* Neutral-800 */
        }
        
        .hybrid-box {
            border: 1px solid #737373; /* Neutral-500 */
            background-color: #E5E5E5; /* Neutral-200 */
        }
        
        .hybrid-box-title {
            color: #171717; /* Neutral-900 */
            font-weight: bold;
        }
        
        .hybrid-box-subtext {
            color: #262626; /* Neutral-800 */
        }
        
        .status-text { /* General class for status text in tables */
            font-weight: bold;
            color: #262626; /* Neutral-800 */
        }
        
        /* ASCII diagram styling */
        .ascii-diagram {
            font-family: 'Courier New', Courier, monospace;
            white-space: pre;
            line-height: 1.2;
            background-color: #FFFFFF;
            padding: 0.75rem;
            border: 1px solid #A3A3A3;
            overflow-x: auto;
            font-size: 0.9rem;
            margin: 0;
        }
        
        /* Book navigation */
        .book-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #A3A3A3;
        }
        
        .book-navigation a {
            padding: 0.5rem 1rem;
            background-color: #E5E5E5;
            border: 1px solid #A3A3A3;
            color: #262626;
            text-decoration: none;
            cursor: pointer;
        }
        
        .book-navigation a:hover {
            background-color: #D4D4D4;
        }
        
        .mobile-menu-button, .mobile-sidebar-button {
            display: none;
        }
        
        /* Loading indicator */
        .loading-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .loading-spinner {
            border: 4px solid #E5E5E5;
            border-top: 4px solid #404040;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Error message */
        .error-message {
            padding: 1rem;
            background-color: #FEE2E2;
            border: 1px solid #EF4444;
            color: #B91C1C;
            margin-bottom: 1rem;
        }
        
        /* Two-column layout for comparison diagrams */
        .two-column-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .column {
            flex: 1;
            min-width: 300px;
            border: 1px solid #737373;
            background-color: #E5E5E5;
            padding: 1.5rem;
        }
        
        .column-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid #A3A3A3;
            padding-bottom: 0.5rem;
            text-align: center;
        }
        
        .column-content {
            padding: 0.5rem;
        }
        
        .connector {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            padding: 0 1rem;
            color: #525252;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .book-container {
                flex-direction: column;
            }
            
            .book-sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
                display: none;
                border-right: none;
                border-bottom: 1px solid #A3A3A3;
                max-height: 300px;
            }
            
            .book-sidebar.active {
                display: block;
            }
            
            .mobile-menu-button, .mobile-sidebar-button {
                display: block;
                background-color: #404040;
                color: #E5E5E5;
                border: 1px solid #737373;
                padding: 0.5rem;
                margin-bottom: 1rem;
                cursor: pointer;
                text-align: center;
                width: 100%;
            }
            
            .nav-container {
                width: 100%;
            }
            
            .nav-links {
                display: none;
                width: 100%;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .book-content {
                padding: 1rem;
            }
            
            .markdown-content h1 {
                font-size: 1.5rem;
            }
            
            .markdown-content h2 {
                font-size: 1.3rem;
            }
            
            .markdown-content h3 {
                font-size: 1.15rem;
            }
            
            .markdown-content h4 {
                font-size: 1rem;
            }
            
            .ascii-diagram {
                font-size: 0.7rem;
            }
            
            .two-column-container {
                flex-direction: column;
            }
            
            .column {
                width: 100%;
            }
            
            .connector {
                transform: rotate(90deg);
                padding: 1rem 0;
            }
        }
        
        /* Print styles */
        @media print {
            .header-bg, .footer-bg, .book-sidebar, .mobile-sidebar-button, .book-navigation {
                display: none !important;
            }
            
            .book-container {
                display: block;
            }
            
            .book-content {
                padding: 0;
            }
            
            .main-container {
                max-width: 100%;
                padding: 0;
            }
        }
    </style>
</head>
<body class="antialiased">
    <header class="header-bg text-white sticky top-0 z-50">
        <nav class="main-container py-1">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex justify-between items-center w-full md:w-auto">
                    <a href="#" class="text-lg font-bold text-white hover:text-neutral-300 transition-colors">Solana AI Registries Initiative</a>
                    <button type="button" class="mobile-menu-button md:hidden" onclick="toggleMenu()">
                        Menu &#9776;
                    </button>
                </div>
                <div class="nav-container mt-1 md:mt-0">
                    <div id="main-nav" class="nav-links flex flex-wrap md:flex-nowrap justify-center md:justify-end">
                        <a href="#" class="nav-link active">Research Book</a>
                        <a href="#" class="nav-link" onclick="downloadPDF()">Download PDF</a>
                        <a href="#" class="nav-link" onclick="window.print()">Print</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <div class="main-container">
        <h1 class="section-title my-6">Solana Protocol Design for Agent and MCP Server Registries</h1>
        
        <button type="button" class="mobile-sidebar-button" onclick="toggleSidebar()">
            Toggle Table of Contents &#9776;
        </button>
        
        <div class="book-container">
            <aside id="book-sidebar" class="book-sidebar">
                <h2 class="font-bold text-lg mb-4 border-b border-neutral-400 pb-2">Table of Contents</h2>
                <div id="chapter-links">
                    <a class="chapter-link" onclick="loadChapter(1)">Chapter 1: Introduction</a>
                    <a class="chapter-link" onclick="loadChapter(2)">Chapter 2: Foundational Solana Concepts</a>
                    <a class="chapter-link" onclick="loadChapter(3)">Chapter 3: Agent Registry Protocol Design</a>
                    <a class="chapter-link" onclick="loadChapter(4)">Chapter 4: MCP Server Registry Protocol Design</a>
                    <a class="chapter-link" onclick="loadChapter(5)">Chapter 5: Discovery and Querying Mechanisms</a>
                    <a class="chapter-link" onclick="loadChapter(6)">Chapter 6: Implementation Guide</a>
                    <a class="chapter-link" onclick="loadChapter(7)">Chapter 7: Security Considerations</a>
                    <a class="chapter-link" onclick="loadChapter(8)">Chapter 8: Performance Optimization</a>
                    <a class="chapter-link" onclick="loadChapter(9)">Chapter 9: Deployment and Maintenance</a>
                    <a class="chapter-link" onclick="loadChapter(10)">Chapter 10: Case Studies and Examples</a>
                    <a class="chapter-link" onclick="loadChapter(11)">Chapter 11: Future Directions</a>
                    <a class="chapter-link" onclick="loadChapter(12)">Chapter 12: Conclusion</a>
                    <a class="chapter-link" onclick="loadChapter(13)">Chapter 13: References</a>
                    <a class="chapter-link" onclick="loadChapter(14)">Chapter 14: Appendices</a>
                </div>
            </aside>
            
            <main id="book-content" class="book-content">
                <div id="markdown-content" class="markdown-content">
                    <!-- Markdown content will be loaded here -->
                    <div class="loading-indicator">
                        <div class="loading-spinner"></div>
                    </div>
                </div>
                <div id="navigation-controls" class="book-navigation">
                    <!-- Navigation controls will be added here -->
                </div>
            </main>
        </div>
    </div>

    <footer class="footer-bg py-6 mt-8">
        <div class="main-container">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="footer-text">© 2025 Solana AI Registries Initiative</p>
                </div>
                <div>
                    <a href="#" class="footer-text hover:text-white mr-4">Privacy Policy</a>
                    <a href="#" class="footer-text hover:text-white">Contact</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Chapter file mapping
        const chapterFiles = {
            1: 'research_draft_part1.md',
            2: 'research_draft_part2.md',
            3: 'research_draft_part3.md',
            4: 'research_draft_part4.md',
            5: 'research_draft_part5.md',
            6: 'research_draft_part6.md',
            7: 'research_draft_part7.md',
            8: 'research_draft_part8.md',
            9: 'research_draft_part9.md',
            10: 'research_draft_part10.md',
            11: 'research_draft_part11.md',
            12: 'research_draft_part12.md',
            13: 'research_draft_part13.md',
            14: 'research_draft_part14.md'
        };
        
        // Current chapter
        let currentChapter = 1;
        
        // Toggle main navigation menu
        function toggleMenu() {
            const navLinks = document.getElementById('main-nav');
            if (navLinks) {
                navLinks.classList.toggle('active');
            }
        }
        
        // Toggle sidebar for mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('book-sidebar');
            if (sidebar) {
                sidebar.classList.toggle('active');
            }
        }
        
        // Load chapter content
        async function loadChapter(chapterNum) {
            try {
                currentChapter = chapterNum;
                
                // Update active chapter link
                const chapterLinks = document.querySelectorAll('.chapter-link');
                chapterLinks.forEach((link, index) => {
                    if (index + 1 === chapterNum) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
                
                // Show loading indicator
                document.getElementById('markdown-content').innerHTML = '<div class="loading-indicator"><div class="loading-spinner"></div></div>';
                
                // Load chapter content
                const response = await fetch(chapterFiles[chapterNum]);
                if (!response.ok) {
                    throw new Error(`Failed to load chapter ${chapterNum}`);
                }
                
                const content = await response.text();
                
                // Configure marked.js renderer to enhance diagrams and tables
                const renderer = new marked.Renderer();
                
                // Enhance code blocks for ASCII diagrams
                const originalCodeRenderer = renderer.code;
                renderer.code = function(code, language, isEscaped) {
                    // Fix for the error: Check if code is a string before using includes
                    if (typeof code === 'string' && (code.includes('+---') || (code.includes('|') && code.includes('-')))) {
                        return `<div class="card">
                                    <pre class="ascii-diagram">${code}</pre>
                                </div>`;
                    }
                    return originalCodeRenderer.call(this, code, language, isEscaped);
                };
                
                // Enhance tables
                const originalTableRenderer = renderer.table;
                renderer.table = function(header, body) {
                    return `<div class="overflow-x-auto">
                              <table class="table-corporate">
                                <thead>${header}</thead>
                                <tbody>${body}</tbody>
                              </table>
                            </div>`;
                };
                
                // Set marked options
                marked.setOptions({
                    renderer: renderer,
                    gfm: true,
                    breaks: true
                });
                
                // Render markdown content
                let renderedContent = marked.parse(content);
                
                // Post-process the rendered HTML to enhance tables and add concept boxes
                renderedContent = enhanceRenderedContent(renderedContent);
                
                document.getElementById('markdown-content').innerHTML = renderedContent;
                
                // Add navigation buttons
                addNavigation(chapterNum);
                
                // Close sidebar on mobile after selection
                if (window.innerWidth <= 768) {
                    document.getElementById('book-sidebar').classList.remove('active');
                }
                
                // Scroll to top
                window.scrollTo(0, 0);
                
                // Update document title
                const chapterTitle = document.querySelector(`.chapter-link:nth-child(${chapterNum})`).textContent;
                document.title = `${chapterTitle} | Solana Protocol Design`;
                
            } catch (error) {
                console.error('Error loading chapter:', error);
                document.getElementById('markdown-content').innerHTML = `
                    <div class="error-message">
                        <h3>Error Loading Chapter</h3>
                        <p>Please ensure all markdown files are in the same directory as this HTML file.</p>
                        <p>Expected file: ${chapterFiles[chapterNum]}</p>
                        <p>Error details: ${error.message}</p>
                    </div>
                    <div class="mt-4">
                        <p>This book requires the following markdown files to be present in the same directory:</p>
                        <ul class="list-disc pl-5 mt-2">
                            ${Object.values(chapterFiles).map(file => `<li>${file}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
        }
        
        // Enhance rendered content with better styling for tables and concept boxes
        function enhanceRenderedContent(html) {
            // Enhance sections that look like concept boxes
            html = html.replace(/<h3>(Rent, Storage &amp; Hybrid Data Model|Program Derived Addresses \(PDAs\)|Account Structures &amp; Borsh Serialization|Key Strategic Objectives:)(.+?)<\/h3>/g, 
                '<div class="info-box"><h3 class="info-box-title">$1$2</h3><div class="info-box-text">');
            
            // Close concept boxes before the next h2 or h3
            html = html.replace(/(<\/div>)(\s*<h[23])/g, '$1</div>$2');
            
            // Create two-column layouts for comparison sections
            if (html.includes('On-Chain Core Data') && html.includes('Off-Chain Extended Metadata')) {
                const pattern = /<h4>On-Chain Core Data<\/h4>([\s\S]*?)<h4>Off-Chain Extended Metadata<\/h4>([\s\S]*?)(<h[23]|<div class="book-navigation">)/;
                const replacement = `
                <div class="two-column-container">
                    <div class="column">
                        <h4 class="column-title">On-Chain Core Data</h4>
                        <div class="column-content">$1</div>
                    </div>
                    <div class="connector">&lt;---&gt;</div>
                    <div class="column">
                        <h4 class="column-title">Off-Chain Extended Metadata</h4>
                        <div class="column-content">$2</div>
                    </div>
                </div>
                $3`;
                
                html = html.replace(pattern, replacement);
            }
            
            // Enhance flow steps
            html = html.replace(/<li>(\d+)\. (Prepare|Invoke|PDA Created|Event Emitted|Update|Deregistration)([^<]+)<\/li>/g, 
                '<li class="flow-step">$1. $2$3</li><div class="flow-arrow">&#8595;</div>');
            
            // Remove last arrow after flow steps
            html = html.replace(/(<\/li><div class="flow-arrow">&#8595;<\/div>)(?!.*<li class="flow-step">)/s, '</li>');
            
            return html;
        }
        
        // Add navigation buttons
        function addNavigation(currentChapter) {
            const totalChapters = Object.keys(chapterFiles).length;
            const nav = document.getElementById('navigation-controls');
            nav.innerHTML = '';
            
            // Previous button
            if (currentChapter > 1) {
                const prevButton = document.createElement('a');
                prevButton.textContent = `← Previous: Chapter ${currentChapter - 1}`;
                prevButton.onclick = () => loadChapter(currentChapter - 1);
                nav.appendChild(prevButton);
            } else {
                // Empty div for spacing
                const spacer = document.createElement('div');
                nav.appendChild(spacer);
            }
            
            // Next button
            if (currentChapter < totalChapters) {
                const nextButton = document.createElement('a');
                nextButton.textContent = `Next: Chapter ${currentChapter + 1} →`;
                nextButton.onclick = () => loadChapter(currentChapter + 1);
                nav.appendChild(nextButton);
            } else {
                // Empty div for spacing
                const spacer = document.createElement('div');
                nav.appendChild(spacer);
            }
        }
        
        // Download PDF function
        function downloadPDF() {
            const pdfUrl = 'solana_protocol_design_for_agent_and_mcp_server_registries.pdf';
            
            // Create a temporary link element
            const link = document.createElement('a');
            link.href = pdfUrl;
            link.download = 'solana_protocol_design_for_agent_and_mcp_server_registries.pdf';
            
            // Append to the document, click, and remove
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Handle keyboard navigation
        document.addEventListener('keydown', function(e) {
            // Left arrow key for previous chapter
            if (e.key === 'ArrowLeft' && currentChapter > 1) {
                loadChapter(currentChapter - 1);
            }
            // Right arrow key for next chapter
            else if (e.key === 'ArrowRight' && currentChapter < Object.keys(chapterFiles).length) {
                loadChapter(currentChapter + 1);
            }
        });
        
        // Load initial chapter on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Default to chapter 1
            loadChapter(1);
            
            // Make sidebar visible on desktop by default
            if (window.innerWidth > 768) {
                document.getElementById('book-sidebar').style.display = 'block';
            }
        });
        
        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                document.getElementById('book-sidebar').style.display = 'block';
            } else {
                document.getElementById('book-sidebar').style.display = 'none';
            }
        });
    </script>
</body>
</html>
